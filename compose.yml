services:
  webserver:
    build: ./server
    ports:
      - "8000:8000"
  prometheus:
    image: prom/prometheus
    ports:
      - "9090:9090"
    volumes:
      - ./prometheus.yml:/etc/prometheus/prometheus.yml
  grafana:
    image: grafana/grafana
    ports:
      - "3000:3000"
  clickhouse:
    image: clickhouse/clickhouse-server
    ports:
      - "8123:8123"  # HTTP interface
      - "9000:9000"  # Native interface
    volumes:
      - clickhouse_data:/var/lib/clickhouse
  vector:
    image: timberio/vector:latest-alpine
    ports:
      - "8383:8383"  # Healthcheck endpoint
    volumes:
      - ./vector.yaml:/etc/vector/vector.yaml
  loki:
    image: grafana/loki:latest
    ports:
      - "3100:3100"
    volumes:
      - ./loki_config.yaml:/etc/loki/loki_config.yaml
volumes:
  clickhouse_data:
